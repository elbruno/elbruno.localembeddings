# Plan â€” DevContainer Support for ElBruno.LocalEmbeddings

Date: 2026-02-13 19:46

## Goal

Add a repository-level VS Code Dev Container configuration that enables contributors to develop and test `ElBruno.LocalEmbeddings` in a consistent .NET 10 Linux environment with persistent caches and parity with the documented workflow (`dotnet restore`, `dotnet build`, `dotnet test`).

## Scope

- Add a single recommended devcontainer for the entire repository.
- Persist both NuGet and local model caches across container rebuilds.
- Provide first-run setup and extension recommendations in devcontainer config.
- Document how to use the container and validate the project inside it.
- Run build/test validation from repo root after changes.

## Non-Goals

- Multi-container orchestration (compose-based setup).
- Pre-baking Hugging Face model artifacts into an image.
- Changing CI workflows.
- Refactoring core embedding runtime logic.

## Implementation Steps

1. **Create baseline Dev Container config**
   - Add `.devcontainer/devcontainer.json`.
   - Use a .NET 10 development image aligned with CI/tooling expectations.
   - Set workspace folder and include essential C#/.NET extensions.
   - Configure `postCreateCommand` to run `dotnet restore` from repo root.

2. **Add persistent caches for performance**
   - Add named volume mounts for:
     - NuGet global packages cache.
     - Local model cache directory used by runtime downloads.
   - Set environment variables inside the container so cache locations are deterministic.

3. **Developer experience defaults**
   - Add container environment defaults that reduce setup friction.
   - Keep settings minimal to avoid overriding personal editor preferences.

4. **Documentation updates**
   - Update `docs/contributing.md` with a short Dev Container section:
     - prerequisites,
     - open/reopen in container,
     - first-run model download expectation,
     - cache persistence notes,
     - in-container validation commands.
   - Optionally add a brief pointer in `README.md` to the contributing guide.

5. **Validation**
   - From repository root, validate:
     - `dotnet restore`
     - `dotnet build`
     - `dotnet test`
   - Ensure no warnings/errors are introduced under strict build settings.

## Acceptance Criteria

- A contributor can open the repository in the Dev Container and start development without manual SDK install.
- NuGet and model caches persist between rebuilds/reopens.
- Documented workflow remains accurate and consistent with in-container behavior.
- Repository builds and tests successfully after adding devcontainer support.

## Risks & Mitigations

- **Risk:** Linux native runtime differences for ONNX.
  - **Mitigation:** keep configuration minimal and document troubleshooting in contributing docs.
- **Risk:** First run is slow due to model download.
  - **Mitigation:** persistent model cache volume + explicit first-run note.
- **Risk:** Policy ambiguity about root cleanliness.
  - **Mitigation:** limit new root artifact to standard `.devcontainer/` folder only.

## Files Expected to Change

- `.devcontainer/devcontainer.json` (new)
- `docs/contributing.md` (update)
- `README.md` (optional minor pointer update)
- `docs/plans/roadmap_260213_0803.md` (optional roadmap entry if accepted)
